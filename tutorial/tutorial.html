<!DOCTYPE html>
<html>
	<head>
		<title>CoderDojo Ponce Springs - Tic Tac Toe Tutorial</title>
		<meta name='viewport' content='width=device-width, initial-scale=1.0'>
	    <link rel='stylesheet' href='lib/bootstrap/css/bootstrap.min.css' />
	    <link rel='stylesheet' href='//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css' />
	    <link href='css/indexa.css' rel='stylesheet' media='screen' />
		<link href='css/snap.css' rel='stylesheet' />
		<link href='css/angular-snap.css' rel='stylesheet' />
	    <style>
body {
	margin: 0;
	padding: 0 !important;
}

iframe {
  background: white;
  height: 300px;
}

.editor {
  border: 1px solid darkgray;
  background: black;
  color: white;
  padding-left: 0 !important;
  padding-right: 0 !important;
}

.ace_wrapper {  
}

.ace_editor {
  height: inherit;
}

.html {
  background: yellow;
}

.css {
  background: orange;
}

.js {
  background: dodgerblue;
}

.modal {
  display: block;
  height: 0;
  overflow: visible;
}

.hide {
    display: none;
}

.navbar {
	margin-bottom: 0 !important;
}
    	</style>
		<script src='lib/jquery/jquery-1.11.0.min.js'></script>	
		<script src='//code.jquery.com/ui/1.10.4/jquery-ui.js'></script>
		<script src='lib/angular/angular.min.js'></script>
		<script src='lib/angular/angular-resource.min.js'></script>
	    <script src='lib/angular-bootstrap/js/ui-bootstrap-tpls-0.10.0.min.js'></script>
	    <script src='lib/bootstrap/js/bootstrap.min.js'></script>
	    <script src="lib/ace/ace.js" charset="utf-8"></script>
	    <script src="lib/ui-ace/ui-ace.js"></script>
	    <script src="lib/snap.js"></script>
	    <script src="lib/angular-snap.js"></script>
	</head>
	<body class='container-fluid center' ng-cloak>
		<!--
	    	<button class='btn btn-info btn-mini' ng-click='peersVisible = !peersVisible' ng-show='!peersVisible'>Show Peers</button>
		-->
		<snap-drawer>
			<div class='container-fluid center'>
				<ul class="nav nav-pills nav-stacked" ng-controller='identityController'>
					<li ng-show='!userLoggedIn'><a class='btn btn-success' href="#" ng-click='showIdentifyUserDialog()'><strong>Log In or Register</strong></a></li>
					<li ng-show='userLoggedIn'><a class='btn btn-success' style='background: darkblue' href="#"><strong>Welcome, {{userName}}!</strong></a></li>
				</ul>				
			    <div style='padding: 3px'><strong>All Challenges</strong> <i class='glyphicon glyphicon-road'></i></div>
				<accordion close-others="true">
					<accordion-group is-open="true">
						<accordion-heading>
					        1: Introducing the Web <i class="pull-right glyphicon glyphicon-chevron-down"></i>
					    </accordion-heading>
					  	Learn the basics of what the web is all about and where it came from.
						<button class='btn btn-success btn-mini' ng-click='stepLoad("01")'>Go</button>
					</accordion-group>
					<accordion-group>
						<accordion-heading>
					        2: Your first game <i class="pull-right glyphicon glyphicon-chevron-down"></i>
					    </accordion-heading>
					  	Build your first game with what you've already learned.
					  	<button class='btn btn-success btn-mini' ng-click='stepLoad("02")'>Go</button>
					</accordion-group>						
				</accordion>
			</div>			
		</snap-drawer>
		<div snap-content ng-controller='tutorialController'>
			<nav class="navbar navbar-default" role="navigation">
			  <a href="#" class="navbar-brand" style='background: lightblue;' snap-toggle='left'><strong>Menu</strong></a> <span class='navbar-brand'><i class='glyphicon glyphicon-signal'></i> <strong>Learnlocity</strong>: <em>accelerate your learning velocity!</em></span>
			</nav>		
		    <div class='container-fluid' id='mainPanel' style='background:lightgray'>
				<button class='btn btn-inverse btn-mini' ng-click='peersVisible = !peersVisible' ng-show='peersVisible'>Hide Peers</button>
		    	<div class='row-fluid'>
				    <tabset ng-cloak class="{{getTutorialClass(peersVisible)}}">
				      <tab heading="Current Challenge">
				      	<div style="height: 500px">
					        <div ng-repeat='stepCode in stepsCode'>
					          <div ng-init='code=stepCode'>
					            <div ng-include="'learnLocityEditor.html'" ng-controller='editorController'></div>
					          </div>
					        </div>
				    	</div>
				      </tab>
				      
				      <tab heading="Classmates">
				        <div ng-repeat='code in peersCode | filter:notMine(code)'>
				          {{code.name}} 
				            <a class='btn btn-primary btn-small' ng-click='peerCodeSpy(code)'>Spy</a>
				        </div>
				        <div ng-repeat='peerCode in peers'>
				          <div ng-init='code=peerCode;previewOnLoad=true'>
				            <div ng-include="'learnLocityEditor.html'" ng-controller='editorController'></div>
				          </div>
				        </div>
				      </tab>
				  	  
				    </tabset>
		    		<div class="span5" style='background: lightyellow;padding:4px' ng-controller='peersController' ng-show='peersVisible'>
		    			<h4>Step Peers</h4>
		    			<tabset>
		    				<tab heading="At Step">
				    			<div class='well well-small'>
				    				<div ng-repeat='peer in peers' class='nav'>
				    					{{peer.name}}	    					
				    				</div>
				    			</div>	    					
		    				</tab>
		    				<tab heading="Need Help">
				    			<div class='well well-small'>
				    				<div ng-repeat='peer in peers' class='nav'>
				    					{{peer.name}}	    					
				    				</div>
				    			</div>
		    				</tab>	    					    		    				
		    				<tab heading="Did Step">
				    			<div class='well well-small'>
				    				<div ng-repeat='peer in peers' class='nav'>
				    					{{peer.name}}	    					
				    				</div>
				    			</div>
		    				</tab>
		    				<tab heading="Gave Help">
				    			<div class='well well-small'>
				    				<div ng-repeat='peer in peers' class='nav'>
				    					{{peer.name}}	    					
				    				</div>
				    			</div>
		    				</tab>
		    			</tabset>
		    			<h4>All Peers</h4>
		    			<tabset>
							<tab heading="Online Now">
				    			<div class='well well-small'>
				    				<div ng-repeat='peer in peers' class='nav'>
				    					{{peer.name}}	    					
				    				</div>
				    			</div>	    					
		    				</tab>
							<tab heading="Offline Now">
				    			<div class='well well-small'>
				    				<div ng-repeat='peer in peers' class='nav'>
				    					{{peer.name}}	    					
				    				</div>
				    			</div>	    					
		    				</tab>	    				
							<tab heading="All">
				    			<div class='well well-small'>
				    				<div ng-repeat='peer in peers' class='nav'>
				    					{{peer.name}}	    					
				    				</div>
				    			</div>	    					
		    				</tab>	    					    				
		    			</tabset>
		    		</div>			    
				</div>
			</div>	
		</div>
	</body>
	<script>
var learnlocity = angular.module('learnlocity',['snap', 'learnlocity.identity', 'learnlocity.editor', 'ui.bootstrap']);
learnlocity.run(function($rootScope) {
	$rootScope.peersVisible = false;
});

learnlocity.controller('peersController', function($rootScope, $scope, $http) {
	$scope.peers = [
		{
			name: 'Josh Gough',
			id: 'JOSH-GOUGH',
			stepsComplete: [1,2,3]
		},
		{
			name: 'Ben Keeble',
			id: 'BEN-KEEBLE',
			stepsComplete: [1,2]
		},
		{
			name: 'Jogo Jogo',
			id: 'JOGO-JOGO',
			stepsComplete: []
		},
	];
});

learnlocity.controller('tutorialController', function($rootScope, $scope, $http, $sce) {
	$scope.getTutorialClass = function() {
		if ($rootScope.peersVisible === undefined) return 'span7';
		if ($rootScope.peersVisible) return 'span7';
		return 'span12';
	};
	$rootScope.notMine = function(code) {
		return function(item) {
			return item.id != "__YOURS__";
		};
	};	

	function initializeCode() {
		$rootScope.peersCode = [];
	  	$rootScope.stepsCode = [];
  	}

  	function createCodeFromXml(data) {
  		initializeCode();
		var xml = new DOMParser().parseFromString(data, "application/xml");
		var name = xml.getElementsByTagName('title')[0].textContent;
		var id = xml.getElementsByTagName('id')[0].textContent;
		var story = xml.getElementsByTagName('section')[0].textContent;
		var html = xml.getElementsByTagName('section')[1].textContent;		
		var js = xml.getElementsByTagName('script')[0].textContent;
		var css = xml.getElementsByTagName('style')[0].textContent;

		var item = {
			name: name,
			id: id,
			storyCode: story,
			code: {
				html: html,
				js: js,
				css: css
			}
		};

		item.story = $sce.trustAsHtml(item.storyCode);		
		
		$rootScope.peersCode.push(item);  	
		if (id == '__YOURS__') {
			$rootScope.stepsCode.push(item);
		}
	}

	$rootScope.stepLoad = function(stepNumber) {
		$rootScope.levelActive = true
		//$http.get('http://www.corsproxy.com/jogoshugh.github.io/CoderDojoPonceSprings.TicTacToe/tutorial/steps/step-' + stepNumber + '.html').success(createCodeFromXml);
		$http.get('steps/step-' + stepNumber + '.html').success(createCodeFromXml);
	}

	$rootScope.peers = [];
	$rootScope.peerCodeSpy = function(code) {
		$rootScope.peers = [];
		$rootScope.peers.push(code);
	};

	$rootScope.stepLoad("01");
});
  </script>
  <script type='text/coffeescript' src='lib/tutorializr/tutorializr.coffee'></script>
  <script type='text/coffeescript' src='lib/learnlocity/learnlocity.identity.coffee'></script>
  <script type='text/coffeescript' src='lib/learnlocity/learnlocity.editor.coffee'></script>
  <script src='lib/mongolab/mongoLabResourceFactory.js'></script>  
  <script type='text/coffeescript' src='lib/learnlocity/learnlocity.api.coffee'></script>  
  <script type="text/javascript" src="lib/coffee/coffee-script.min.js"></script>
  <script type="text/coffeescript">
$ ->
  angular.bootstrap document, ['learnlocity', 'ui.bootstrap']
  </script>
</html>